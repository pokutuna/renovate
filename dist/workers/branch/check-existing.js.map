{"version":3,"file":"check-existing.js","sourceRoot":"","sources":["../../../lib/workers/branch/check-existing.ts"],"names":[],"mappings":";;;AAAA,mEAAoE;AACpE,iEAGuC;AACvC,yCAAsC;AACtC,6CAA0C;AAG1C,+BAA+B;AACxB,KAAK,UAAU,gBAAgB,CACpC,MAAoB;IAEpB,eAAM,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,EAAE,kBAAkB,CAAC,CAAC;IAC7C,IAAI,MAAM,CAAC,cAAc,EAAE;QACzB,eAAM,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC;KACb;IACD,eAAM,CAAC,KAAK,CAAC,yBAAyB,CAAC,CAAC;IACxC,oCAAoC;IACpC,MAAM,EAAE,GAAG,MAAM,mBAAQ,CAAC,MAAM,CAAC;QAC/B,UAAU,EAAE,MAAM,CAAC,UAAU;QAC7B,OAAO,EAAE,MAAM,CAAC,OAAO;QACvB,KAAK,EAAE,iCAAiB;KACzB,CAAC,CAAC;IACH,IAAI,EAAE,EAAE;QACN,eAAM,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;QACnD,MAAM,SAAS,GAAG,MAAM,mBAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAClD,qBAAqB;QACrB,IAAI,SAAS,CAAC,KAAK,KAAK,6BAAa,EAAE;YACrC,eAAM,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;YAC5B,MAAM,IAAI,KAAK,CAAC,mCAAkB,CAAC,CAAC;SACrC;QACD,OAAO,EAAE,CAAC;KACX;IACD,eAAM,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;IACvC,OAAO,IAAI,CAAC;AACd,CAAC;AA3BD,4CA2BC","sourcesContent":["import { REPOSITORY_CHANGED } from '../../constants/error-messages';\nimport {\n  PR_STATE_NOT_OPEN,\n  PR_STATE_OPEN,\n} from '../../constants/pull-requests';\nimport { logger } from '../../logger';\nimport { platform } from '../../platform';\nimport { BranchConfig } from '../common';\n\n/** TODO: Proper return type */\nexport async function prAlreadyExisted(\n  config: BranchConfig\n): Promise<any | null> {\n  logger.trace({ config }, 'prAlreadyExisted');\n  if (config.recreateClosed) {\n    logger.debug('recreateClosed is true');\n    return null;\n  }\n  logger.debug('recreateClosed is false');\n  // Return if same PR already existed\n  const pr = await platform.findPr({\n    branchName: config.branchName,\n    prTitle: config.prTitle,\n    state: PR_STATE_NOT_OPEN,\n  });\n  if (pr) {\n    logger.debug('Found closed PR with current title');\n    const prDetails = await platform.getPr(pr.number);\n    // istanbul ignore if\n    if (prDetails.state === PR_STATE_OPEN) {\n      logger.debug('PR reopened');\n      throw new Error(REPOSITORY_CHANGED);\n    }\n    return pr;\n  }\n  logger.debug('prAlreadyExisted=false');\n  return null;\n}\n"]}