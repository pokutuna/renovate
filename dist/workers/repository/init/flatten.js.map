{"version":3,"file":"flatten.js","sourceRoot":"","sources":["../../../../lib/workers/repository/init/flatten.ts"],"names":[],"mappings":";;;AAAA,4CAAgE;AAChE,4CAAyC;AAEzC,SAAgB,mBAAmB,CACjC,YAA2B;;IAE3B,MAAM,GAAG,GAAkB,EAAE,CAAC;IAC9B,IAAI,EAAC,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,CAAA,EAAE;QACzB,OAAO,GAAG,CAAC;KACZ;IACD,KAAK,MAAM,IAAI,IAAI,YAAY,EAAE;QAC/B,UAAI,IAAI,CAAC,YAAY,0CAAE,MAAM,EAAE;YAC7B,eAAM,CAAC,KAAK,CAAC,gCAAgC,CAAC,CAAC;YAC/C,KAAK,MAAM,OAAO,IAAI,IAAI,CAAC,YAAY,EAAE;gBACvC,MAAM,YAAY,GAAG,yBAAgB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBACrD,OAAO,YAAY,CAAC,YAAY,CAAC;gBACjC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACxB;SACF;aAAM;YACL,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAChB;KACF;IACD,OAAO,GAAG,CAAC;AACb,CAAC;AApBD,kDAoBC","sourcesContent":["import { PackageRule, mergeChildConfig } from '../../../config';\nimport { logger } from '../../../logger';\n\nexport function flattenPackageRules(\n  packageRules: PackageRule[]\n): PackageRule[] {\n  const res: PackageRule[] = [];\n  if (!packageRules?.length) {\n    return res;\n  }\n  for (const rule of packageRules) {\n    if (rule.packageRules?.length) {\n      logger.debug('Flattening nested packageRules');\n      for (const subrule of rule.packageRules) {\n        const combinedRule = mergeChildConfig(rule, subrule);\n        delete combinedRule.packageRules;\n        res.push(combinedRule);\n      }\n    } else {\n      res.push(rule);\n    }\n  }\n  return res;\n}\n"]}