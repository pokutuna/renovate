{"version":3,"file":"extract.js","sourceRoot":"","sources":["../../../lib/manager/github-actions/extract.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,yCAAsC;AACtC,0EAA4D;AAE5D,mDAA+C;AAE/C,SAAgB,kBAAkB,CAAC,OAAe;IAChD,eAAM,CAAC,KAAK,CAAC,qCAAqC,CAAC,CAAC;IACpD,MAAM,IAAI,GAAwB,EAAE,CAAC;IACrC,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;QACtC,qEAAqE;QACrE,4CAA4C;QAC5C,MAAM,KAAK,GACT,qCAAqC,CAAC,IAAI,CAAC,IAAI,CAAC;YAChD,kCAAkC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAChD,IAAI,KAAK,EAAE;YACT,MAAM,CAAC,EAAE,WAAW,CAAC,GAAG,KAAK,CAAC;YAC9B,MAAM,GAAG,GAAG,gBAAM,CAAC,WAAW,CAAC,CAAC;YAChC,eAAM,CAAC,KAAK,CACV;gBACE,OAAO,EAAE,GAAG,CAAC,OAAO;gBACpB,YAAY,EAAE,GAAG,CAAC,YAAY;gBAC9B,aAAa,EAAE,GAAG,CAAC,aAAa;aACjC,EACD,oCAAoC,CACrC,CAAC;YACF,GAAG,CAAC,UAAU,GAAG,gBAAgB,CAAC,EAAE,CAAC;YACrC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAChB;KACF;IACD,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;QAChB,OAAO,IAAI,CAAC;KACb;IACD,OAAO,EAAE,IAAI,EAAE,CAAC;AAClB,CAAC;AA5BD,gDA4BC","sourcesContent":["import { logger } from '../../logger';\nimport * as dockerVersioning from '../../versioning/docker';\nimport { PackageDependency, PackageFile } from '../common';\nimport { getDep } from '../dockerfile/extract';\n\nexport function extractPackageFile(content: string): PackageFile | null {\n  logger.debug('github-actions.extractPackageFile()');\n  const deps: PackageDependency[] = [];\n  for (const line of content.split('\\n')) {\n    // old github actions syntax will be deprecated on September 30, 2019\n    // after that, the first line can be removed\n    const match =\n      /^\\s+uses = \"docker:\\/\\/([^\"]+)\"\\s*$/.exec(line) ||\n      /^\\s+uses: docker:\\/\\/([^\"]+)\\s*$/.exec(line);\n    if (match) {\n      const [, currentFrom] = match;\n      const dep = getDep(currentFrom);\n      logger.debug(\n        {\n          depName: dep.depName,\n          currentValue: dep.currentValue,\n          currentDigest: dep.currentDigest,\n        },\n        'Docker image inside GitHub Actions'\n      );\n      dep.versioning = dockerVersioning.id;\n      deps.push(dep);\n    }\n  }\n  if (!deps.length) {\n    return null;\n  }\n  return { deps };\n}\n"]}